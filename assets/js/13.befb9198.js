(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{673:function(t,e,i){},764:function(t,e,i){"use strict";i(673)},779:function(t,e,i){"use strict";i.r(e);i(638),i(639),i(640),i(19),i(735),i(739),i(742),i(743),i(746),i(748),i(750),i(754),i(756),i(762);window.URL=window.URL||window.webkitURL,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;let s=function(t,e){(e=e||{}).sampleBits=e.sampleBits||8,e.sampleRate=e.sampleRate||7350;let i=new(window.webkitAudioContext||window.AudioContext),r=i.createMediaStreamSource(t),a=i.createScriptProcessor||i.createJavaScriptNode;this.source=i.createBufferSource();let n=a.apply(i,[4096,1,1]),o={size:0,buffer:[],inputSampleRate:i.sampleRate,inputSampleBits:16,outputSampleRate:e.sampleRate,oututSampleBits:e.sampleBits,input:function(t){this.buffer.push(new Float32Array(t)),this.size+=t.length},compress:function(){let t=new Float32Array(this.size),e=0;for(let i=0;i<this.buffer.length;i++)t.set(this.buffer[i],e),e+=this.buffer[i].length;let i=parseInt(this.inputSampleRate/this.outputSampleRate),s=t.length/i,r=new Float32Array(s),a=0,n=0;for(;a<s;)r[a]=t[n],n+=i,a++;return r},encodeWAV:function(){let t=Math.min(this.inputSampleRate,this.outputSampleRate),e=Math.min(this.inputSampleBits,this.oututSampleBits),i=this.compress(),s=i.length*(e/8),r=new ArrayBuffer(44+s),a=new DataView(r),n=0,o=function(t){for(let e=0;e<t.length;e++)a.setUint8(n+e,t.charCodeAt(e))};if(o("RIFF"),n+=4,a.setUint32(n,36+s,!0),n+=4,o("WAVE"),n+=4,o("fmt "),n+=4,a.setUint32(n,16,!0),n+=4,a.setUint16(n,1,!0),n+=2,a.setUint16(n,1,!0),n+=2,a.setUint32(n,t,!0),n+=4,a.setUint32(n,1*t*(e/8),!0),n+=4,a.setUint16(n,e/8*1,!0),n+=2,a.setUint16(n,e,!0),n+=2,o("data"),n+=4,a.setUint32(n,s,!0),n+=4,8===e)for(let t=0;t<i.length;t++,n++){let e=Math.max(-1,Math.min(1,i[t])),s=e<0?32768*e:32767*e;s=parseInt(255/(65535/(s+32768))),a.setInt8(n,s,!0)}else for(let t=0;t<i.length;t++,n+=2){let e=Math.max(-1,Math.min(1,i[t]));a.setInt16(n,e<0?32768*e:32767*e,!0)}return new Blob([a],{type:"audio/mp3"})}};this.start=function(){r.connect(n),n.connect(i.destination)},this.stop=function(){n.disconnect()},this.getBlob=function(){return this.stop(),o.encodeWAV()},this.play=function(t){let e=document.getElementById("downloadRec");e.href=window.URL.createObjectURL(this.getBlob()),e.download=(new Date).toLocaleString()+".mp3",t.src=window.URL.createObjectURL(this.getBlob())},this.upload=function(t,e){let i=new FormData;i.append("audioData",this.getBlob());let s=new XMLHttpRequest;e&&(s.upload.addEventListener("progress",(function(t){e("uploading",t)}),!1),s.addEventListener("load",(function(t){e("ok",t)}),!1),s.addEventListener("error",(function(t){e("error",t)}),!1),s.addEventListener("abort",(function(t){e("cancel",t)}),!1)),s.open("POST",t),s.send(i)},s.recorder=n};s.throwError=function(t){throw alert(t),new function(){this.toString=function(){return t}}},s.canRecording=null!=navigator.getUserMedia,s.get=function(t,e){if(t){if(!navigator.getUserMedia)return void s.throwErr("当前浏览器不支持录音功能。");navigator.getUserMedia({audio:!0},(function(i){let r=new s(i,e);t(r)}),(function(t){switch(t.code||t.name){case"PERMISSION_DENIED":case"PermissionDeniedError":s.throwError("用户拒绝提供信息。");break;case"NOT_SUPPORTED_ERROR":case"NotSupportedError":s.throwError("浏览器不支持硬件设备。");break;case"MANDATORY_UNSATISFIED_ERROR":case"MandatoryUnsatisfiedError":s.throwError("无法发现指定的硬件设备。");break;default:s.throwError("无法打开麦克风。异常信息:"+(t.code||t.name))}}))}};var r=s,a={name:"VueRecord",watch:{DB(t){t>=1&&t<=20?this.voice=1:t>=21&&t<=40?this.voice=2:t>=41&&t<=60?this.voice=3:t>=71&&t<=90?this.voice=4:t>=91&&t<=120?this.voice=5:t>=121&&t<=140?this.voice=6:t>=141&&t<=160?this.voice=7:t>=161&&t<=180?this.voice=8:t>=181&&t<=200?this.voice=9:t>200&&(this.voice=10)}},methods:{clearTimer(){this.interval&&(this.num=60,clearInterval(this.interval))},beginOrStopRecorder(){if(this.interval)this.stop();else{this.clearTimer(),this.startTime=(new Date).getTime();var t=this;r.get(e=>{e&&(this.flag?(this.mouseEnd(),this.flag=!1):(this.recorder=e,this.interval=setInterval(()=>{this.num<=0?(this.recorder.stop(),this.num=60,this.clearTimer()):(this.num--,this.time="松开结束（"+this.num+"秒）",this.recorder.start(),r.recorder.onaudioprocess=function(e){for(var i=e.inputBuffer.getChannelData(0),s=0,r=0;r<i.length;r++)s<i[r]&&(s=i[r]);t.DB=parseInt(1e4*s)})},1e3)))})}},stop(){if(this.clearTimer(),this.endTime=(new Date).getTime(),this.recorderTime=Math.round((this.endTime-this.startTime)/1e3),this.recorderTime<1)console.log("录音时间过短，请重新录入");else if(this.recorder){this.recorder.stop(),this.num=60,this.time="按住说话（"+this.num+"秒）";let t=this.recorder.getBlob(),e=URL.createObjectURL(t);this.form.audioUrl=e,this.voice=0}}},data:()=>({DB:0,form:{time:"按住说话(60秒)",audioUrl:""},num:60,recorder:null,interval:"",audioFileList:[],startTime:"",endTime:"",recorderTime:0,voice:0})},n=(i(764),i(2)),o=Object(n.a)(a,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"layouts-recorder"},[e("div",{staticClass:"circle"},[e("div",{staticClass:"mask",on:{click:t.beginOrStopRecorder}})]),t._v("\n  开始\n  "),e("button",{staticClass:"stop",on:{click:t.stop}},[t._v("停止")]),t._v(" "),e("button",{on:{click:function(e){return t.recorder.play()}}},[t._v("回放")]),t._v(" "),e("audio",{attrs:{src:t.form.audioUrl,controls:"controls"}},[t._v("音频")]),t._v(" "),e("div",{staticClass:"spectrum"},[e("div",{staticClass:"spectrum-left"},[e("span",{class:{red:this.voice>=1}}),t._v(" "),e("span",{class:{red:this.voice>=2}}),t._v(" "),e("span",{class:{red:this.voice>=3}}),t._v(" "),e("span",{class:{red:this.voice>=4}}),t._v(" "),e("span",{class:{red:this.voice>=5}}),t._v(" "),e("span",{class:{red:this.voice>=6}}),t._v(" "),e("span",{class:{red:this.voice>=7}}),t._v(" "),e("span",{class:{red:this.voice>=8}}),t._v(" "),e("span",{class:{red:this.voice>=9}}),t._v(" "),e("span",{class:{red:this.voice>=10}})]),t._v(" "),e("div",{staticClass:"spectrum-right"},[e("span",{class:{red:this.voice>=1}}),t._v(" "),e("span",{class:{red:this.voice>=2}}),t._v(" "),e("span",{class:{red:this.voice>=3}}),t._v(" "),e("span",{class:{red:this.voice>=4}}),t._v(" "),e("span",{class:{red:this.voice>=5}}),t._v(" "),e("span",{class:{red:this.voice>=6}}),t._v(" "),e("span",{class:{red:this.voice>=7}}),t._v(" "),e("span",{class:{red:this.voice>=8}}),t._v(" "),e("span",{class:{red:this.voice>=9}}),t._v(" "),e("span",{class:{red:this.voice>=10}})])])])}),[],!1,null,null,null);e.default=o.exports}}]);